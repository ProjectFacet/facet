<!-- Audio Asset Modal -->

<div class="modal fade" id="AudioAssetModal" tabindex="-1" role="dialog" aria-labelledby="AudioAssetModal">
  <div class="modal-dialog modal-lg" role="audio">
    <div class="modal-content">
      <div class="bs-nav-tabs nav-tabs-default">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <ul class="nav nav-tabs nav-animated-border-from-left">
            <li class="nav-item"> <a ng-href="" class="nav-link active" data-toggle="tab" data-target="#uploadaudio">Upload a Audio</a></li>
            <li class="nav-item"> <a ng-href="" class="nav-link" data-toggle="tab" data-target="#audiolibrary">Select From Audio Library</a></li>
          </ul>
        </div>
        {% with view.facet_audio_assets as audio_assets %}
        <div class="modal-body" id="audiomodalbody">
          <div class="tab-content">
            <!-- UPLOAD PANEL -->
            <div role="tabpanel" class="tab-pane active" id="uploadaudio">
              <div class="uploadpanel" data-toggle="slimScroll" style="height:500px" data-color="#5D9CEC" data-allow-page-scroll="false">
              <form action="{% url 'upload_audio' %}" method="POST" class="post-form" enctype="multipart/form-data">
              {% csrf_token %}

                <!-- Left Col -->
                <div class="col-md-6">

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.audio.label_tag }}</label>
                    {{ audio_assets.uploadform.audio }}
                    {% if audio_assets.uploadform.audio.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.audio.errors }}</small>
                    {% endif %}
                  </fieldset>

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.link.label_tag }}</label>
                    {{ audio_assets.uploadform.link }}
                    {% if audio_assets.uploadform.link.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.link.errors }}</small>
                    {% endif %}
                  </fieldset>

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.title.label_tag }}</label>
                    {{ audio_assets.uploadform.title }}
                    {% if audio_assets.uploadform.title.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.title.errors }}</small>
                    {% endif %}
                  </fieldset>

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.asset_type.label_tag }}</label>
                    {{ audio_assets.uploadform.asset_type }}
                    {% if audio_assets.uploadform.asset_type.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.asset_type.errors }}</small>
                    {% endif %}
                  </fieldset>

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.keywords.label_tag }}</label>
                    {{ audio_assets.uploadform.keywords }}
                    {% if audio_assets.uploadform.keywords.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.keywords.errors }}</small>
                    {% endif %}
                  </fieldset>

                </div>
                <!-- End Left Col -->
                <!-- Right Col -->
                <div class="col-md-6">

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.description.label_tag }}</label>
                    {{ audio_assets.uploadform.description }}
                    {% if audio_assets.uploadform.description.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.description.errors }}</small>
                    {% endif %}
                  </fieldset>

                  <fieldset class="form-group m-b-10">
                    <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ audio_assets.uploadform.attribution.label_tag }}</label>
                    {{ audio_assets.uploadform.attribution }}
                    {% if audio_assets.uploadform.attribution.errors %}
                      <small class="text-muted">{{ audio_assets.uploadform.attribution.errors }}</small>
                    {% endif %}
                  </fieldset>

                </div>
                <!-- End Right Col -->
                <!-- ===================================== -->
                <!-- ===================================== -->
                <div class="hidden-image-inputs">
                    <input type="hidden" name="facet" value="{{ facet.pk }}" />
                </div>
                <!-- ===================================== -->
                <!-- ===================================== -->
                <div>
                    <button type="submit" class="btn btn-primary m-l-20">Save Audio</button>
                </div>

              </form>
              </div>
            </div>
            <!-- END UPLOAD PANEL -->

            <!-- LIBRARY PANEL -->
            <div role="tabpanel" class="tab-pane" id="audiolibrary">
              <div class="audiolibrary" data-toggle="slimScroll" style="height:500px" data-color="#5D9CEC" data-allow-page-scroll="false">
                <form action="{% url 'add_audio' %}" method="POST" class="post-form" name="addaudio">
                  {% csrf_token %}
                  <div class="row audio-library">
                  {% for audio in audio_assets.org_audio %}
                    <div class="col-md-3">
                      {% if audio.asset_type == 'MP3' or audio.asset_type == 'WAV' %}
                      <div id="jplayer_audio_{{audio.pk}}" class="jp-jplayer"></div>
                      <div id="jp_container_audio_{{audio.pk}}" class="jp-flat-audio m-b-10" role="application" aria-label="media player">
                        <div class="jp-play-control jp-control">
                          <button class="jp-play jp-button" role="button" aria-label="play" tabindex="0"></button>
                        </div>
                        <div class="jp-bar">
                          <div class="jp-seek-bar jp-seek-bar-display"></div>
                          <div class="jp-seek-bar">
                            <div class="jp-play-bar"></div>
                            <div class="jp-details"><span class="jp-title" aria-label="title"></span></div>
                            <div class="jp-timing"><span class="jp-duration" role="timer" aria-label="duration"></span></div>
                          </div>
                        </div>
                        <div class="jp-no-solution">
                          Media Player Error<br />
                          Update your browser or Flash plugin
                        </div>
                      </div>
                      <script>
                        jQuery(document).ready(function($) {
                          $("#jplayer_audio_{{audio.pk}}").jPlayer({
                            ready: function(event) {
                              $(this).jPlayer("setMedia", {
                                title: "{{audio.title}}",
                                wav: "{{audio.audio.url}}",
                                mp3: "{{audio.audio.url}}",
                              });
                            },
                            play: function() { // Avoid multiple jPlayers playing together.
                              $(this).jPlayer("pauseOthers");
                            },
                            timeFormat: {
                              padMin: false
                            },
                            swfPath: "js",
                            supplied: "wav, mp3",
                            cssSelectorAncestor: "#jp_container_audio_{{audio.pk}}",
                            useStateClassSkin: true,
                            autoBlur: false,
                            smoothPlayBar: true,
                            remainingDuration: true,
                            keyEnabled: true,
                            keyBindings: {
                              // Disable some of the default key controls
                              loop: null,
                              muted: null,
                              volumeUp: null,
                              volumeDown: null
                            },
                            wmode: "window"
                          });
                        });
                      </script>
                      {% endif %}
                    </div>
                    <div class="col-md-1">
                      <label>
                        {% if audio in audio_assets.audio %}
                        <i class="fa fa-check-square subtle" aria-hidden="true"></i>
                        {% else %}
                        <input class="inline" type="checkbox" name="audio" value="{{ audio.id }}">
                        {% endif %}
                      </label>
                    </div>
                    {% if forloop.counter|divisibleby:"6" and not forloop.last %}
                      </div><div class="row">
                    {% endif %}
                  {% endfor %}
                  </div>

                <!-- ===================================== -->
                <!-- ===================================== -->
                <div class="hidden-image-inputs">
                    <input type="hidden" name="facet" value="{{ facet.pk }}" />
                </div>
                <!-- ===================================== -->
                <!-- ===================================== -->

                  <div class="row">
                    <div class="col-xs-12">
                      <button type="submit" class="btn btn-primary" name="addaudio">Add Audio</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
            <!-- END LIBRARY PANEL -->
          </div>
        </div>
        {% endwith %}
        </div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div>
</div>
