{% extends 'base.html' %}

{% load i18n %}
{% load bootstrap3 %}
{% load embed_video_tags %}

{% block head %}
{{ webform.media }}
{% endblock %}

<!-- ================================================= -->
<!-- ================================================= -->
<!--             BREADCRUMB NAVIGATION                 -->
<!-- ================================================= -->
<!-- ================================================= -->

{% block breadcrumb %}
<div>
    <ol class="breadcrumb icon-angle-right icon-th">
        <li class="fadeIn"><a href="{% url 'dashboard' %}" title="Go to Dashboard"> Dashboard </a></li>
        <li class="fadeIn"> Create a Pitch </li>
    </ol>
</div>
{% endblock breadcrumb %}

<!-- ================================================= -->
<!-- ================================================= -->
<!--                   Main Section                    -->
<!-- ================================================= -->
<!-- ================================================= -->

{% block content %}
<!-- ================================================= -->
                    <!-- CONTENT -->
<!-- ================================================= -->

<div class="row m-b-20">
  <div class="col-xs-12">
    <h4>Create a Pitch</h4>
  </div>
</div>

<div class="row">
  <form method="POST" class="post-form forms-basic">
    {% csrf_token %}

    <!-- Left Column -->
    <div class="col-xs-12 col-sm-6">
      <!-- Reciptient -->
      <div class="row">
        <fieldset class="form-group m-b-20">
          <div class="col-xs-2 offset-xs-1">
            <label>{{ form.recipient.label_tag }}</label>
          </div>
          <div class="col-xs-9">
            {{ form.recipient }}
            {% if form.recipient.errors %}
            <small class="text-muted">{{ form.recipient.errors }}</small>
            {% endif %}
          </div>
        </fieldset>
      </div>
      <!-- Name -->
      <div class="row">
        <fieldset class="form-group m-b-20">
          <div class="col-xs-2 offset-xs-1">
            <label>{{ form.name.label_tag }}</label>
          </div>
          <div class="col-xs-9">
            {{ form.name }}
            {% if form.name.errors %}
            <small class="text-muted">{{ form.name.errors }}</small>
            {% endif %}
          </div>
        </fieldset>
      </div>
      <!-- Status -->
      <div class="row">
        <fieldset class="form-group m-b-20">
          <div class="col-xs-2 offset-xs-1">
            <label>{{ form.status.label_tag }}</label>
          </div>
          <div class="col-xs-9">
            {{ form.status }}
            {% if form.status.errors %}
            <small class="text-muted">{{ form.status.errors }}</small>
            {% endif %}
          </div>
        </fieldset>
      </div>
      <!-- Exclusive -->
      <div class="row">
        <fieldset class="form-group m-b-20">
          <div class="col-xs-2 offset-xs-1">
            <label>{{ form.exclusive.label_tag }}</label>
          </div>
          <div class="col-xs-9">
            {{ form.exclusive }}
            {% if form.exclusive.errors %}
            <small class="text-muted">{{ form.exclusive.errors }}</small>
            {% endif %}
          </div>
        </fieldset>
      </div>
    </div>
    <!-- Right Column -->
    <div class="col-xs-12 col-sm-6">
      <!-- Text -->
      <div class="row">
        <fieldset class="form-group m-b-20">
          <div class="col-xs-2 offset-xs-1">
            <label>{{ form.text.label_tag }}</label>
          </div>
          <div class="col-xs-9">
            {{ form.text }}
            {% if form.text.errors %}
            <small class="text-muted">{{ form.text.errors }}</small>
            {% endif %}
          </div>
        </fieldset>
      </div>
      <!-- Save/Cancel Buttons -->
      <div class="row">
        <div class="col-xs-12">
          {% if pitch.id %}
          <a href="{% url 'pitch_detail' pitch.id %}" title="Cancel"><button class="save btn btn-danger-100 m-t-40 m-r-10 pull-right">Cancel</button></a>
          {% else %}
          <a href="{% url 'pitch_new' %}" title="Cancel"><button class="save btn btn-danger-100 m-t-40 m-r-10 pull-right">Cancel</button></a>
          {% endif %}
          <button type="submit" class="save btn btn-default m-t-40 m-r-10 pull-right">Save</button>
        </div>
      </div>
    </div>
  </form>
</div>


{% if pitch.id %}
<div class="row m-b-20">
  <div class="col-xs-12">
    <h4>Assets</h4>
  </div>
</div>
<div class="row m-t-20">
  <!-- Images -->
  {% with view.pitch_simple_image_assets as images %}
  <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">
    <p class="f-r-12 f-w-300 m-b-20">Images <a href="#" data-toggle="modal" data-target="#SimpleImageAssetModal" title="Add Image"><i class="fa fa-plus sameline subtle"></i></a></p>
    <div id="image-thumbs">
      <div class="row m-b-10">
        {% for image in images %}
          {% if image.display_photo %}
            <div class="col-xs-4">
              <a href="{{ image.display_photo.url }}" class="thumbnail"><img src="{{ image.display_photo.url }}" alt="{{ image.description }}" class="img-fluid"></a>
            </div>
            {% if forloop.counter|divisibleby:"3" and not forloop.last %}
              </div><div class="row m-b-10">
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
  {% endwith %}
  <!-- Documents -->
  <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">

  </div>
  <!-- Audio -->
  <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">

  </div>
  <!-- Video -->
  <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">

  </div>

</div>
{% else %}
<p>Save pitch in order to add assets to it.</p>
{% endif %}



<!-- ================================================= -->
                  <!-- JS SCRIPTS -->
<!-- ================================================= -->


{% endblock %}

<!-- ================================================= -->
<!-- ================================================= -->
                <!-- MODALS -->
<!-- ================================================= -->
<!-- ================================================= -->

{% block modals %}

<!-- Image Asset Modal -->
{% with view.pitch_simple_image_assets as images %}
<div class="modal fade" id="SimpleImageAssetModal" tabindex="-1" role="dialog" aria-labelledby="SimpleImageAssetModal">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="bs-nav-tabs nav-tabs-default">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <ul class="nav nav-tabs nav-animated-border-from-left">
            <li class="nav-item"> <a ng-href="" class="nav-link active" data-toggle="tab" data-target="#uploadimage">Upload a Photo</a></li>
          </ul>
        </div>
        {% with view.facet_image_assets as image_assets %}
        <div class="modal-body" id="imagemodalbody">
          <div class="tab-content">
            <!-- UPLOAD PANEL -->
            <div role="tabpanel" class="tab-pane active" id="uploadimage">
              <div class="uploadpanel" data-toggle="slimScroll" style="height:500px" data-color="#5D9CEC" data-allow-page-scroll="false">
              <form action="{% url 'upload_simple_image' %}" method="POST" class="post-form" enctype="multipart/form-data">
              {% csrf_token %}
              <!-- Left Col -->
              <div class="col-md-6">

                <fieldset class="form-group m-b-10">
                  <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ images.form.photo.label_tag }}</label>
                  {{ images.form.photo }}
                  {% if images.form.photo.errors %}
                    <small class="text-muted">{{ images.form.photo.errors }}</small>
                  {% endif %}
                </fieldset>

                <fieldset class="form-group m-b-10">
                  <label class="f-s-14 f-s-400 spread-01 subtle slim-margin"><span class="field-label">{{ images.form.title.label_tag }}</label>
                  {{ images.form.title }}
                  {% if images.form.title.errors %}
                    <small class="text-muted">{{ images.form.title.errors }}</small>
                  {% endif %}
                </fieldset>

              </div>
              <!-- End Left Col -->
              <!-- Right Col -->
              <div class="col-md-6">

                <fieldset class="form-group m-b-10">
                  <label class="f-s-14 f-s-400 spread-01 subtle slim-margin">{{ images.form.description.label_tag }}</label>
                  {{ images.form.description }}
                  {% if images.form.description.errors %}
                    <small class="text-muted">{{ images.form.description.errors }}</small>
                  {% endif %}
                </fieldset>


              </div>
              <!-- End Right Col -->
              <!-- ===================================== -->
              <!-- ===================================== -->
              <div class="hidden-image-inputs">
                  <input type="hidden" name="association" value="pitch" />
                  <input type="hidden" name="pitch" value="{{ pitch.pk }}" />
              </div>
              <!-- ===================================== -->
              <!-- ===================================== -->
              <div>
                <button type="submit" class="btn btn-primary m-l-20">Save Image</button>
              </div>
              </form>
              </div>
            </div>
            <!-- END UPLOAD PANEL -->


          </div>
        </div>
        {% endwith %}
        </div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div>
  {% endwith %}
</div>




{% endblock modals %}
